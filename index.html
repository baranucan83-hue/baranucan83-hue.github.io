<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>SecureCore</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:white;
  text-align:center;
  padding-top:60px;
}
h1{font-size:40px;}
input{
  padding:12px;
  width:80%;
  max-width:350px;
  border-radius:8px;
  border:none;
  margin:10px 0;
}
button{
  padding:12px 20px;
  font-size:16px;
  border:none;
  border-radius:8px;
  background:#00c6ff;
  color:white;
  cursor:pointer;
  margin:5px;
}
#sonuc{
  margin-top:20px;
  font-size:18px;
  word-wrap:break-word;
}
</style>
</head>
<body>

<h1>SecureCore üîê</h1>
<p>G√º√ßl√º AES-256 ≈ûifreleme</p>

<input type="text" id="secretKey" placeholder="Gizli anahtar gir">
<br>
<input type="text" id="metin" placeholder="Mesaj gir">
<br>

<button onclick="sifrele()">≈ûifrele</button>
<button onclick="coz()">≈ûifre √á√∂z</button>

<div id="sonuc"></div>

<script>

async function getKey(password){
  const enc = new TextEncoder();
  const hash = await crypto.subtle.digest("SHA-256", enc.encode(password));
  return crypto.subtle.importKey(
    "raw",
    hash,
    { name: "AES-GCM" },
    false,
    ["encrypt","decrypt"]
  );
}

function arrayBufferToBase64(buffer){
  let binary="";
  let bytes=new Uint8Array(buffer);
  for(let i=0;i<bytes.byteLength;i++){
    binary+=String.fromCharCode(bytes[i]);
  }
  return btoa(binary);
}

function base64ToArrayBuffer(base64){
  let binary=atob(base64);
  let bytes=new Uint8Array(binary.length);
  for(let i=0;i<binary.length;i++){
    bytes[i]=binary.charCodeAt(i);
  }
  return bytes;
}

async function sifrele(){
  const password=document.getElementById("secretKey").value;
  const text=document.getElementById("metin").value;

  if(!password||!text){
    alert("Anahtar ve mesaj gerekli!");
    return;
  }

  const key=await getKey(password);
  const iv=crypto.getRandomValues(new Uint8Array(12));

  const enc=new TextEncoder();
  const cipher=await crypto.subtle.encrypt(
    {name:"AES-GCM",iv:iv},
    key,
    enc.encode(text)
  );

  const combined=new Uint8Array(iv.length + cipher.byteLength);
  combined.set(iv,0);
  combined.set(new Uint8Array(cipher),iv.length);

  document.getElementById("sonuc").innerText=
    "≈ûifreli:\n"+arrayBufferToBase64(combined);
}

async function coz(){
  const password=document.getElementById("secretKey").value;
  const text=document.getElementById("metin").value;

  if(!password||!text){
    alert("Anahtar ve ≈üifreli metin gerekli!");
    return;
  }

  try{
    const key=await getKey(password);
    const data=base64ToArrayBuffer(text);

    const iv=data.slice(0,12);
    const cipher=data.slice(12);

    const decrypted=await crypto.subtle.decrypt(
      {name:"AES-GCM",iv:iv},
      key,
      cipher
    );

    const dec=new TextDecoder();
    document.getElementById("sonuc").innerText=
      "√á√∂z√ºld√º:\n"+dec.decode(decrypted);

  }catch(e){
    document.getElementById("sonuc").innerText=
      "Hatalƒ± anahtar veya bozuk veri!";
  }
}

</script>
</body>
</html>
